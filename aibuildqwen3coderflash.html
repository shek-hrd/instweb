<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Web App Builder</title>
    <style>
        /* Basic styling for layout */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            background-color: #f5f5f5;
        }

        header {
            background-color: #333;
            color: white;
            padding: 1rem;
            text-align: center;
        }

        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .input-section {
            width: 50%;
            padding: 1rem;
            border-right: 1px solid #ccc;
            overflow-y: auto;
        }

        .preview-section {
            width: 50%;
            padding: 1rem;
            display: flex;
            flex-direction: column;
        }

        textarea {
            width: 100%;
            height: 200px;
            margin-bottom: 1rem;
            padding: 0.5rem;
            box-sizing: border-box;
        }

        button {
            padding: 0.75rem;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            margin-bottom: 1rem;
            font-size: 1rem;
        }

        button:hover {
            background-color: #0056b3;
        }

        #previewFrame {
            flex: 1;
            border: 1px solid #ccc;
            background-color: white;
        }

        #statusMessage {
            margin-top: 1rem;
            padding: 0.5rem;
            background-color: #e9ecef;
            border-radius: 4px;
        }

        .loading {
            color: #007bff;
            font-style: italic;
        }
    </style>
</head>
<body>
    <header>
        <h1>AI Web App Builder</h1>
        <p>Describe your app, and we'll generate it using Claude AI!</p>
    </header>

    <div class="container">
        <!-- Input Section -->
        <div class="input-section">
            <h2>Describe Your App</h2>
            <textarea id="appDescription" placeholder="Enter a description of the web application you want to build..."></textarea>
            <button id="generateBtn">Generate App</button>
            <div id="statusMessage">Ready to generate your app.</div>
        </div>

        <!-- Preview Section -->
        <div class="preview-section">
            <h2>Preview</h2>
            <iframe id="previewFrame" title="Generated App Preview"></iframe>
        </div>
    </div>

    <!-- Include Puter.js library -->
    <script src="https://js.puter.com/v2/"></script>

    <script>
        // DOM Elements
        const appDescriptionInput = document.getElementById('appDescription');
        const generateBtn = document.getElementById('generateBtn');
        const previewFrame = document.getElementById('previewFrame');
        const statusMessage = document.getElementById('statusMessage');

        // Function to update the status message
        function updateStatus(message, isError = false) {
            statusMessage.textContent = message;
            statusMessage.className = isError ? 'error' : 'loading';
        }

        // Function to generate the HTML code for the app
        async function generateAppCode(description) {
            // Define the prompt for Claude
            const prompt = `
                Generate a complete, self-contained HTML file for a web application based on this description: "${description}".
                The output should be valid HTML code only, including embedded CSS and JavaScript if needed.
                Do not include any explanations or markdown formatting. Just the raw HTML code.
                Make sure it's a single HTML file that works when opened directly in a browser.
                The application should be visually appealing and functional.
                Ensure the generated code uses modern web standards.
                Please make the generated code as robust and clean as possible.
            `;

            try {
                // Call Puter.js to interact with Claude
                // Using Claude Sonnet 4 for balanced performance
                const response = await puter.ai.chat(prompt, { model: 'claude-sonnet-4' });
                // Extract the text content from the AI response
                return response.message.content[0].text;
            } catch (error) {
                console.error('Error generating app:', error);
                throw new Error('Failed to generate app. Please try again.');
            }
        }

        // Function to load the generated HTML into the iframe
        function loadPreview(htmlContent) {
            // Create a blob from the HTML string
            const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
            // Create an object URL for the blob
            const url = URL.createObjectURL(blob);
            // Set the iframe's source to the blob URL
            previewFrame.src = url;
        }

        // Event listener for the generate button
        generateBtn.addEventListener('click', async () => {
            const description = appDescriptionInput.value.trim();

            // Validate input
            if (!description) {
                updateStatus('Please enter a description for your app.', true);
                return;
            }

            // Update status to indicate processing
            updateStatus('Generating your app...');

            try {
                // Generate the HTML code
                const htmlCode = await generateAppCode(description);

                // Load the generated code into the preview iframe
                loadPreview(htmlCode);

                // Update status to success
                updateStatus('App generated successfully!');
            } catch (error) {
                // Handle errors during generation
                updateStatus(`Error: ${error.message}`, true);
            }
        });

        // Optional: Generate an example app on page load
        window.addEventListener('load', () => {
            // Pre-fill the input with an example description
            appDescriptionInput.value = "A simple todo list app with add, delete, and mark complete functionality.";
            // Optionally trigger generation automatically on load
            // generateBtn.click();
        });
    </script>
</body>
</html>